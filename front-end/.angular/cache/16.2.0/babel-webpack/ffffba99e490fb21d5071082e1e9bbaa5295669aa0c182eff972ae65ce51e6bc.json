{"ast":null,"code":"var _class;\nimport swal from 'sweetalert2';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"@angular/forms\";\nimport * as i2 from \"@angular/common/http\";\nimport * as i3 from \"@angular/router\";\nexport class PostComponent {\n  constructor(formbuilder, http, router) {\n    this.formbuilder = formbuilder;\n    this.http = http;\n    this.router = router;\n    this.post = {\n      content: '',\n      image: ''\n    };\n    this.selectedFile = null;\n  }\n  ngOnInit() {\n    this.form = this.formbuilder.group({\n      content: [''],\n      image: ['']\n    });\n  }\n  onFileSelected(event) {\n    this.selectedFile = event.target.files[0];\n  }\n  submit() {\n    const content = this.form.get('content')?.value;\n    const image = this.selectedFile;\n    if (!content && !image) {\n      swal.fire('Error!', 'Please provide either post content or an image.', 'error');\n      return;\n    }\n    const user = this.form.getRawValue();\n    this.http.post(\"http://localhost:9000/user/login\", user, {\n      withCredentials: true\n    }).subscribe(response => {\n      const successMessage = response.message;\n      swal.fire({\n        title: 'Success!',\n        text: successMessage,\n        icon: 'success',\n        timer: 1500,\n        showConfirmButton: false\n      });\n      this.router.navigate(['/']);\n    }, err => {\n      console.error(\"Login error:\", err);\n      swal.fire('Error!', err.error?.message, 'error');\n    });\n  }\n  submitPost() {\n    if (this.selectedFile) {\n      const formData = new FormData();\n      formData.append('content', this.post.content);\n      formData.append('image', this.selectedFile, this.selectedFile.name);\n      this.http.post('http://localhost:8080/posts', formData).subscribe(response => {\n        console.log(response);\n        this.post.content = '';\n        this.selectedFile = null;\n      }, error => {\n        console.error(error);\n      });\n    } else {\n      this.http.post('http://localhost:8080/posts', this.post).subscribe(response => {\n        console.log(response);\n        this.post.content = '';\n      });\n    }\n  }\n}\n_class = PostComponent;\n_class.ɵfac = function PostComponent_Factory(t) {\n  return new (t || _class)(i0.ɵɵdirectiveInject(i1.FormBuilder), i0.ɵɵdirectiveInject(i2.HttpClient), i0.ɵɵdirectiveInject(i3.Router));\n};\n_class.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n  type: _class,\n  selectors: [[\"app-post\"]],\n  decls: 9,\n  vars: 2,\n  consts: [[3, \"formGroup\", \"ngSubmit\"], [\"for\", \"content\"], [\"id\", \"content\", \"name\", \"content\", \"placeholder\", \"Write your post here...\", \"required\", \"\", 3, \"ngModel\", \"ngModelChange\"], [\"type\", \"file\", \"name\", \"image\", 1, \"a\", 3, \"change\"], [\"type\", \"submit\", \"value\", \"POST\"]],\n  template: function PostComponent_Template(rf, ctx) {\n    if (rf & 1) {\n      i0.ɵɵelementStart(0, \"h2\");\n      i0.ɵɵtext(1, \"Create a Post\");\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementStart(2, \"form\", 0);\n      i0.ɵɵlistener(\"ngSubmit\", function PostComponent_Template_form_ngSubmit_2_listener() {\n        return ctx.submit();\n      });\n      i0.ɵɵelementStart(3, \"div\")(4, \"label\", 1);\n      i0.ɵɵtext(5, \"Content:\");\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementStart(6, \"textarea\", 2);\n      i0.ɵɵlistener(\"ngModelChange\", function PostComponent_Template_textarea_ngModelChange_6_listener($event) {\n        return ctx.post.content = $event;\n      });\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementStart(7, \"input\", 3);\n      i0.ɵɵlistener(\"change\", function PostComponent_Template_input_change_7_listener($event) {\n        return ctx.onFileSelected($event);\n      });\n      i0.ɵɵelementEnd()();\n      i0.ɵɵelement(8, \"input\", 4);\n      i0.ɵɵelementEnd();\n    }\n    if (rf & 2) {\n      i0.ɵɵadvance(2);\n      i0.ɵɵproperty(\"formGroup\", ctx.form);\n      i0.ɵɵadvance(4);\n      i0.ɵɵproperty(\"ngModel\", ctx.post.content);\n    }\n  },\n  dependencies: [i1.ɵNgNoValidate, i1.DefaultValueAccessor, i1.NgControlStatus, i1.NgControlStatusGroup, i1.RequiredValidator, i1.NgModel, i1.FormGroupDirective],\n  styles: [\"/*# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IiIsInNvdXJjZVJvb3QiOiIifQ== */\"]\n});","map":{"version":3,"names":["swal","PostComponent","constructor","formbuilder","http","router","post","content","image","selectedFile","ngOnInit","form","group","onFileSelected","event","target","files","submit","get","value","fire","user","getRawValue","withCredentials","subscribe","response","successMessage","message","title","text","icon","timer","showConfirmButton","navigate","err","console","error","submitPost","formData","FormData","append","name","log","i0","ɵɵdirectiveInject","i1","FormBuilder","i2","HttpClient","i3","Router","selectors","decls","vars","consts","template","PostComponent_Template","rf","ctx","ɵɵelementStart","ɵɵtext","ɵɵelementEnd","ɵɵlistener","PostComponent_Template_form_ngSubmit_2_listener","PostComponent_Template_textarea_ngModelChange_6_listener","$event","PostComponent_Template_input_change_7_listener","ɵɵelement","ɵɵadvance","ɵɵproperty"],"sources":["C:\\Users\\HP\\Desktop\\cpp\\new\\distributed_system\\front-end\\src\\app\\post\\post.component.ts","C:\\Users\\HP\\Desktop\\cpp\\new\\distributed_system\\front-end\\src\\app\\post\\post.component.html"],"sourcesContent":["import { HttpClient } from '@angular/common/http';\nimport { Component, OnInit } from '@angular/core';\nimport { FormBuilder, FormGroup, Validators } from '@angular/forms';\nimport { Router } from '@angular/router';\nimport swal from 'sweetalert2';\n\n@Component({\n  selector: 'app-post',\n  templateUrl: './post.component.html',\n  styleUrls: ['./post.component.css']\n})\nexport class PostComponent implements OnInit{\n  form:FormGroup\n\n  constructor(private formbuilder:FormBuilder, private http:HttpClient, private router:Router){}\n  ngOnInit():void{\n    this.form = this.formbuilder.group({\n      content: [''],\n      image: [''],\n    });\n  }\n  post = {\n    content: '',\n    image:''\n  };\nloggedInUser: any;\n\nselectedFile: File | null = null;\n  onFileSelected(event: any) {\n    this.selectedFile = event.target.files[0];\n  }\n  submit(): void {\n    const content = this.form.get('content')?.value;\n    const image = this.selectedFile;\n\n    if (!content && !image) {\n      swal.fire('Error!', 'Please provide either post content or an image.', 'error');\n      return;\n    }\n\n    const user = this.form.getRawValue();\n\n    this.http.post(\"http://localhost:9000/user/login\", user, {\n      withCredentials: true\n    })\n    .subscribe(\n      (response: any) => {\n        const successMessage = response.message; \n        swal.fire({\n          title: 'Success!',\n          text: successMessage,\n          icon: 'success',\n          timer: 1500,\n          showConfirmButton: false\n        });\n        this.router.navigate(['/']); \n      },\n      (err: any) => {\n        console.error(\"Login error:\", err);\n        swal.fire('Error!', err.error?.message, 'error');\n      });\n    }\n\n  submitPost() {\n    if (this.selectedFile) {\n      const formData = new FormData();\n      formData.append('content', this.post.content);\n      formData.append('image', this.selectedFile, this.selectedFile.name);\n\n      this.http.post<any>('http://localhost:8080/posts', formData).subscribe(\n        (response) => {\n          console.log(response);\n          this.post.content = '';\n          this.selectedFile= null;\n        },\n        (error) => {\n          console.error(error);\n        }\n      );\n    } else {\n      this.http.post('http://localhost:8080/posts', this.post)\n        .subscribe((response: any) => {\n          console.log(response);\n          this.post.content = '';\n        });\n    }\n  }\n}\n\n","<h2>Create a Post</h2>\n\n<form [formGroup]=\"form\" (ngSubmit)=\"submit()\">\n  <div>\n    <label for=\"content\">Content:</label>\n    <textarea id=\"content\" [(ngModel)]=\"post.content\" name=\"content\" placeholder=\"Write your post here...\" required></textarea>\n    <input type=\"file\"  name=\"image\" class=\"a\" (change)=\"onFileSelected($event)\" />\n  </div>\n  <input type=\"submit\" value=\"POST\">\n</form>\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}